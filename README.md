# SocAI - Alert Classification with ChatGPT

SocAI is an artificial intelligence application built to classify alerts as either possible false positives or genuine incidents. It utilizes the power of ChatGPT, a state-of-the-art language model developed by OpenAI, to make predictions based on the information provided in the alert, previous logs, and related alerts.
## Environment Variables

To successfully run SocAI, make sure to set the following environment variables:

- `CASSANDRA_DATABASE_KEYSPACE`: The keyspace name of your Cassandra database.
- `CASSANDRA_DATABASE_TOKEN`:  The token to authenticate with your Cassandra database.
- `OPENAI_API_KEY`: Your OpenAI API key.
- `SECURE_CONNECT_BUNDLE_PATH`: The path to your secure connect bundle file for your Cassandra database.
- `TABLE_NAME`: The name of the Cassandra table to create.
- `THREATWINDS_API_KEY`: Your ThreatWinds API key.
- `THREATWINDS_API_SECRET`: Your ThreatWinds API secret.

## Local Deployment

To deploy SocAI locally, follow these steps:

1. Clone the SocAI repository from GitHub.
2. Navigate to the cloned repository's directory.
3. Install the required Python dependencies:

```shell
pip install -r requirements.txt
```

Ensure the necessary environment variables are set. Replace `<value>` with the respective values for your environment:

```shell
export PYTHONUNBUFFERED=1
export CASSANDRA_DATABASE_KEYSPACE=<value>
export CASSANDRA_DATABASE_TOKEN=<value>
export OPENAI_API_KEY=<value>
export SECURE_CONNECT_BUNDLE_PATH=<value>
export TABLE_NAME=<value>
export THREATWINDS_API_KEY=<value>
export THREATWINDS_API_SECRET=<value>

```

Run the application:

```shell
python main.py
```

SocAI will now be running locally and will be accessible on port 8000.

To classify an alert, send a POST request to the `/process` endpoint with a JSON payload containing the information.

You can use the Swagger UI generated by FastAPI to test the API. To access the Swagger UI, navigate to `http://127.0.0.1:8000/docs` in your web browser. From there, you can explore the available endpoints, including the  `/process` endpoint, and send requests with the appropriate payload.

Upon the successful classification of an alert, the resulting prediction is preserved in a structured format within a Cassandra database.

The table encapsulates detailed information, including the original alert content, involved domains, IPs, email addresses, the system's evaluation, and its rationale for the assigned classification, along with any recommended next steps. 

The alert body vector - a critical feature used in the classification process - is also captured, stored as a 1536-dimension float vector.

The Cassandra table's structure is detailed below:

```cassandraql
CREATE TABLE IF NOT EXISTS {self.keyspace}.{self.table} (
   id TEXT PRIMARY KEY,
   alert_body TEXT,
   domain_list LIST<text>,
   ip_list LIST<text>,
   email_list LIST<text>,
   evaluation TEXT,
   reasoning TEXT,
   next_steps TEXT,
   alert_body_vector VECTOR<FLOAT, 1536>
)